---
title: "PowerPoint with R Markdown"
author: "Nathan Stephens"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
---

<center><img src="img/rmd2ppt.png" style="width: 400px;"/></center>

***

# Getting started

RStudio makes it easy to render PowerPoint presentations from [R Markdown](https://rmarkdown.rstudio.com/) documents. This capability is made possible by recent improvements to [Pandoc](http://pandoc.org/releases.html), `rmarkdown`, and the RStudio IDE. To use all the features of RStudio with PowerPoint output, install the [RStudio Preview](https://www.rstudio.com/products/rstudio/download/preview/) which bundles Pandoc 2.x. You should also install **rmarkdown** >= v1.9.

```
devtools::install_github("rstudio/rmarkdown")
```

### Open new

[RStudio Preview](https://www.rstudio.com/products/rstudio/download/preview/) now offers PowerPoint as an output format for R Markdown documents:

`New File` > `R Markdown` > `Presentation` > `PowerPoint`

<center><img src="img/openppt.png" style="width: 400px;"/></center>


### Quick example

To create a PowerPoint presentation from R Markdown, you specify the `powerpoint_presentation` output format in the YAML metadata of your document. 

````markdown
---
title: "Untitled"
output: powerpoint_presentation
---

`r ''````{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

### R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

### Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

### Slide with R Output

`r ''````{r cars, echo = TRUE}
summary(cars)
```

### Slide with Plot

`r ''````{r pressure}
plot(pressure)
```
````


### Knit to PowerPoint

When you knit the R Markdown document, RStudio renders your document in the PowerPoint output format. If you are using RStudio desktop, your PowerPoint presentation will automatically open and take you back to the last slide you were on. If you are using RStudio Server, you will be prompted to download the PowerPoint presentation.

<center><img src="img/knit2ppt.png" style="width: 200px;"/></center>

<br>

You can also render files programmatically. 

```
rmarkdown::render(input = "input.Rmd", output_format = "powerpoint_presentation", output_file = "output.pptx")
```

### Post rendering adjustments

Markdown elements are rendered as natively in PowerPoint. Manually changing the slide size or design after rendering will automatically change titles, content, tables, and other elements.

***

# Markdown features

You can generate most elements supported by Pandoc’s Markdown in PowerPoint output, such as inline formatting, lists, LaTeX math expressions/equations, images, hyperlinks, bock quotations, etc. See the [R Markdown Reference](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf) for a complete summary.

```
*italics* 
**bold** 
~~strikeout~~ 
~subscipt~
^superscripts^
[small caps]{.smallcaps} 
`verbatim`

1. Numbered list
* Unnumbered list

$math-expression$
$$math-equation$$

[link](target) 

> Block quotations
```

Additionally, the PowerPoint output format also supports these handy features:

* [Columns](#columns) as defined in *Two Content* layout
* [Templates](#templates) for changing slide size and design
* [Speaker notes](#speaker-notes) for presenter view and handouts
* [Images and tables](#images-and-tables) placed on their own slides

### Columns

To put material in side by side columns, you can use a native div container with class `columns`, containing two containers with class `column`:

```
:::::::::::::: {.columns}
::: {.column}
contents...
:::
::: {.column}
contents...
:::
::::::::::::::
```

### Templates

Change the slide size or design with a reference doc when the presentation is rendered.

```
---
title: My presentation
output: 
  powerpoint_presentation:
    reference_doc: template.pptx
---
```

Any template included with a recent install of Microsoft PowerPoint (either with .pptx or .potx extension) should work, as will most templates derived from these. The specific requirement is that the template should contain the following four layouts as its first four layouts:

1. Title. Defined by the YAML header.
2. Section header. Break the presentation into sections. These slides have a section header but no content.
3. Title and content. Content slide.
4. Two Content. Content with two columns.

All templates included with a recent version of MS PowerPoint will fit these criteria. (You can click on Layout under the Home menu to check.) You can access the default reference.pptx by running: `pandoc --print-default-data-file reference.pptx > custom-reference.pptx`

### Speaker notes

Add speaker notes to slides. Speaker notes support limited formats such as bold, italics, and lists. Speaker notes will be available in handouts and presenter view.

```
::: notes
This is my note.

- It can contain Markdown
- like this list
:::
```

### Images and tables

Insert static images from file or from the web. Captions will render below the image. You can add a link to the caption or to the image itself. 

```
# Insert from file
![](file)

# Insert from web
![](URL)

# Plain image
![caption](image) plain image

# Linked image
[![caption](image)](link)

# Linked caption
![[caption](link)](image)
```

Create native PowerPoint tables that recognize PowerPoint table designs. Table output from markdown will assume the table design of whatever template is applied.

```
 manufacturer    displ   hwy     class
-------------    ------  -----  ---------
        audi     1.8     29      compact
   chevrolet     5.3     20        suv
       dodge     2.4     24      minivan
```

Note that images and tables will always be placed on new slides. The only elements that can coexist with an image or table on a slide are the slide header and caption. When you have a text paragraph and an image on the same slide, the image will be moved to a new slide automatically. Images will be scaled automatically to fit the slide.

***

# Structuring the presentation

By default, the slide level is the highest header level in the hierarchy that is followed immediately by content, and not another header, somewhere in the document. This default can be overridden using the `slide-level` option. The document is carved up into slides according to the following rules:

* A horizontal rule always starts a new slide
* A header at the slide level always starts a new slide
* Headers below the slide level in the hierarchy create headers within a slide
* Headers above the slide level in the hierarchy create *section headers*
* A title page is constructed automatically from the document’s title block

These rules are designed to support many different styles of slide show. If you don’t care about structuring your slides into sections and subsections, you can just use level 1 headers for all each slide. (In that case, level 1 will be the slide level.) But you can also structure the slide show into sections, as in the example above.

### Example

This presentation sets `slide_level: 3`. The result will be a presentation with three slides: (1) a section header slide; (2) a content slide for the comment, "By default..."; and (3) a title and content slide for the rest of the content. Without the override this presentation would have been rendered to a single slide. The default rules would set `slide_level: 1` because the section header is immediately followed by content.

```
---
output: 
  powerpoint_presentation:
    slide_level: 3
---

# Section Header
By default, content here would normally set this as the slide level 

### Title and Content Slide
The override sets this as the new slide level

#### Bold text
Text
```

***

# R Code Chunks

[R Code Chunks](https://rmarkdown.rstudio.com/authoring_rcodechunks.html) can be used as a means to render R output into documents or to simply display code for illustration. Pandoc supports syntax highlighting for R code chunks.

### Table output

By default data frames and matrices are output as they would be in the R terminal (in a monospaced font). However, if you prefer that data be displayed as a PowerPoint table you can use the `knitr::kable` function. Table output from `knitr:kable` will assume the table design of whatever template is applied.

```
knitr::kable(mtcars)
```

### Plot output

R code chunks can also be used to render plots. Images will be scaled automatically to fit the slide. You can change image size in with `fig.width` and `fig.height` code chunk options.

```
plot(cars)
```

### Webshots

Capture [HTML Widgets](http://www.htmlwidgets.org/) and [Shiny apps](http://shiny.rstudio.com/) with the `webshot` package. With the `webshot` package, you can embed a screenshot of a Shiny application that links viewers to a live application hosted on RStudio Connect, Shiny Server, or Shinyapps.io.

Install the [webshots](https://cran.r-project.org/web/packages/webshot/vignettes/intro.html) package and [phantomjs](http://phantomjs.org/). The `webshot` package will automatically take a screenshot of an interactive HTML Widget and insert it into your presentation. Use `knitr::include_app` to include a Shiny application in your presentation. Viewers can click the image in PowerPoint to link back to the hosted app online.

```
# Install
install.packages("webshot")
webshot::install_phantomjs()

# HTML Widget
dygraphs::dygraph(nhtemp, main = "New Haven Temperatures")

# Shiny
knitr::include_app('https://gallery.shinyapps.io/goog-trend-index/')
```

### Code chunk options

These code [chunk options](https://yihui.name/knitr/options/) can be useful when rendering PowerPoint output. 

* `cache`. Save time by caching plots and other output.
* `screenshot.opts`. Allow apps to load before taking a screenshot.
* `fig.width`. Specify figure width.
* `fig.heigth`. Specify figure height.
* `fig.cap`. Add a caption to an image.

```
{r, cache=TRUE, screenshot.opts=list(delay=1), fig.width=15, fig.cap="caption"}
```

***

# References

[Markdown Basics](https://rmarkdown.rstudio.com/authoring_basics.html)

[Pandoc Markdown](https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html)

[R Code Chunks](https://rmarkdown.rstudio.com/authoring_rcodechunks.html)

[Chunk Options](https://yihui.name/knitr/options/)

[Pandoc Manual](http://pandoc.org/MANUAL.html)

[Examples: PowerPoint output with R](https://github.com/sol-eng/powerpoint)

[Submit an issues to rmarkdown](https://github.com/rstudio/rmarkdown/issues)
