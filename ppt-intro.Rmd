---
title: Rendering PowerPoint Presentations
subtitle: With R Markdown
author: RStudio Inc.
output: powerpoint_presentation
---

```{r setup, include=FALSE}
library(ggplot2)
library(dygraphs)
```

## Open a new presentation

![](img/openppt.png)

## Example R Markdown

```
---
title: My presentation
output: powerpoint_presentation
---

# Section Header Slide

## Title and Content Slide

* Bullet 1
* Bullet 2

## Slide 2

![](image.png)
```

## Knit to PowerPoint

![](img/knit2ppt.png)

# Markdown features

## Standard features

* Inline formatting: *italics*, **bold**, ~~strikeout~~, ~sub~^super^scripts, [small caps]{.smallcaps}, `verbatim`
* Lists
    1. Numbered
    2. Unnumbered
* Images
* [Links](https://en.wikipedia.org/wiki/Lynx#/media/File:Lynx_lynx_poing.jpg) 
* Block quotations
* LaTeX math expressions and equations: $e^{i\pi}+1$

## Columns

::::::: {.columns}
::: {.column}
Create slides with two columns. Insert text and images into columns. 
```
::::::: {.columns}
::: {.column}
Column 1
:::
::: {.column}
Column 2
:::
:::::::
```
:::
::: {.column}
![[R for Data Science](http://r4ds.had.co.nz/)](http://r4ds.had.co.nz/cover.png)
:::
:::::::

## Templates

Change the slide size or design with a reference doc when the presentation is rendered.

```
---
title: My presentation
output: 
  powerpoint_presentation:
    reference_doc: template.pptx
---
```


## PowerPoint tables with formatting

 manufacturer    displ   hwy     class
-------------    ------  -----  ---------
        audi     1.8     29      compact
   chevrolet     5.3     20        suv
       dodge     2.4     24      minivan

## Code blocks

R code chunks render with syntax highlighting.

```{r eval=FALSE}
library(tidyverse)
nycflights13::flights %>%
  filter(year == 2013 & month == 6) %>%
  group_by(carrier) %>%
  mutate(diff = (dep_delay - arr_delay)^2) %>%
  summarize(mean = mean(diff, na.rm = TRUE)) %>%
  arrange(desc(mean)) %>%
  top_n(5)
```

## Speaker notes

Add speaker notes to title and content slides.

```
::: notes
here are my notes
:::
```

::: notes
here are my notes
:::

# R Output

## Knitr Tables

```{r, echo=FALSE}
knitr::kable(head(iris, 8))
```

::: notes
{r, echo=FALSE}
knitr::kable(head(iris, 4))
:::

## Visualizations with ggplot2

```{r echo=FALSE, fig.height=3, fig.width=6, fig.cap="Highway miles per gallon vs engine displacement"}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth(method = "loess")
```

::: notes
{r echo=FALSE, fig.height=3, fig.width=6, fig.cap="Highway miles per gallon vs engine displacement"}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth(method = "loess")
:::

## HTML Widget Webshot

```{r echo=FALSE, fig.height=3, fig.width=6, fig.cap="Screenshot of interactive dygraph"}
dygraph(nhtemp, main = "New Haven Temperatures") %>% 
  dyRangeSelector(dateWindow = c("1920-01-01", "1960-01-01"))
```

::: notes
{r echo=FALSE, fig.height=3, fig.width=6, fig.cap="Screenshot of interactive dygraph"}
dygraph(nhtemp, main = "New Haven Temperatures") %>% 
  dyRangeSelector(dateWindow = c("1920-01-01", "1960-01-01"))
:::

## Shiny App Webshot 

```{r cache=TRUE, screenshot.opts=list(delay=1), echo=FALSE, fig.cap="Click image to open"}
knitr::include_app('https://gallery.shinyapps.io/goog-trend-index/')
```

::: notes
{r cache=TRUE, screenshot.opts=list(delay=1), echo=FALSE, fig.cap="Click image to open"}
knitr::include_app('https://gallery.shinyapps.io/goog-trend-index/')
:::

# Other Details

## Getting started

1. Download [RStudio Preview](https://www.rstudio.com/products/rstudio/download/preview/)
2. Download `rmarkdown` from [GitHub](https://github.com/rstudio/rmarkdown)

```
devtools::install_github("rstudio/rmarkdown")
```

## How to render the presentation

1. Press the `knit` button to render the presentation in RStudio
2. Or render from the command line

```
> pandoc habits.txt -o habits.pptx
```

## How to take a Webshot

Install webshot package and install phantomjs.

```
install.packages("webshot")
webshot::install_phantomjs()
```

Use inlcude_app to webshot an app.

```
knitr::include_app('<URL>')
```

## Useful code chunk options

* Caching
    * `cache=TRUE`
    * Save time by caching plots and other output
* Screenshot delay
    * `screenshot.opts=list(delay=1)`
    * Allow apps to load before taking a screenshot
* Captions
    * `fig.cap="caption"`
    * Add a caption to an image

## Slide types

1. **Title**. Defined in the YAML header.
2. **Section header**. Break the presentation into sections. These slides have a section header but no content.
3. **Title and content**. Presentation content.
4. **Two Content**. Presentation content in two columns.

See the [Pandoc Manual](http://pandoc.org/MANUAL.html) for specific rules on controlling the `slide-level` option

## References

Getting help

* [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/powerpoint-presentation.html)
* [Authoring Basics](https://rmarkdown.rstudio.com/authoring_basics.html)
* [Authoring Pandoc Markdown](https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html)
* [R Code Chunks](https://rmarkdown.rstudio.com/authoring_rcodechunks.html)
* [Pandoc Manual](http://pandoc.org/MANUAL.html)

Submitting issues

* [rmarkdown/issues](https://github.com/rstudio/rmarkdown/issues)
